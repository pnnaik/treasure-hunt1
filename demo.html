<!doctype html>
<html lang="gu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Scanner тЖТ Winner</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .modal-centered { display:flex; align-items:center; justify-content:center; min-height:60vh; }
    .confetti { position:fixed; pointer-events:none; z-index:1055; }
    .car-logo { width:100px; }
  </style>
</head>
<body class="p-4">

<div class="container text-center">
  <h3>Scan тЖТ Winner</h3>
  <button id="mockScanBtn" class="btn btn-primary mt-3">Mock Scan</button>
  <div id="log" class="mt-3"></div>
</div>

<!-- Logo Modal -->
<div id="logoModal" class="modal" tabindex="-1">
  <div class="modal-dialog modal-centered">
    <div class="modal-content text-center p-4">
      <!-- <p>
        Chori
        <span>
          <img src="https://img.indianautosblog.com/2020/03/24/maruti-swift-front-three-quarters-left-side-4a8f.jpg" class="car-logo mb-3" alt="Car Logo">
        </span> -->
      </p>
      <h5>ЁЯО╡ ркЧрлАркд ркЪрк╛рк▓рлА рк░рк╣рлНркпрлБркВ ркЫрлЗ... ЁЯО╡</h5>
      <button id="nextBtn" class="btn btn-primary mt-3" disabled>Next</button>
    </div>
  </div>
</div>

<!-- Number Check Modal -->
<div id="carModal" class="modal" tabindex="-1">
  <div class="modal-dialog modal-centered">
    <div class="modal-content text-center p-4">
      <h5>ркдркорк╛рк░рлЛ ркиркВркмрк░ ркирк╛ркЦрлЛ</h5>
      <input id="carInput" type="text" class="form-control text-center" placeholder="enter number" maxlength="10">
      <p id="carHint" class="text-muted small mt-2"></p>
      <button class="btn btn-success mt-3" onclick="checkCar()">Check</button>
    </div>
  </div>
</div>

<!-- Winner Modal -->
<div id="winnerModal" class="modal" tabindex="-1">
  <div class="modal-dialog modal-centered">
    <div class="modal-content text-center p-4">
      <h4>ркЕркнрк┐ркиркВркжрки ЁЯОЙ ркдркорлЗ Winner ркЫрлЛ!</h4>
    </div>
  </div>
</div>

<!-- ЁЯФК Local Sounds -->
<audio id="songAudio" src="song.mp3" preload="auto"></audio> <!-- ЁЯСЙ local mp3 file -->
<audio id="winSound" src="win.mp3" preload="auto"></audio> <!-- optional local win sound -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const logoModal = new bootstrap.Modal(document.getElementById('logoModal'), {backdrop:'static', keyboard:false});
  const carModal = new bootstrap.Modal(document.getElementById('carModal'), {backdrop:'static', keyboard:false});
  const wModal = new bootstrap.Modal(document.getElementById('winnerModal'), {backdrop:'static', keyboard:false});

  const correctCar = "GJ21DD6644";
  const song = document.getElementById('songAudio');
  const nextBtn = document.getElementById('nextBtn');

  document.getElementById('mockScanBtn').addEventListener('click', ()=>{
    log('QR Code Scanned тЬЕ');
    logoModal.show();
    playSongBeforeNext();
  });

  function playSongBeforeNext(){
    song.currentTime = 0;
    song.play().catch(()=>{});
    song.addEventListener('ended', ()=>{
      nextBtn.disabled = false;
      nextBtn.innerText = "Next тЖТ";
    }, { once: true }); // тЬЕ only once
  }

  nextBtn.addEventListener('click', ()=>{
    song.pause();
    logoModal.hide();
    carModal.show();
  });

  function checkCar(){
    const car = document.getElementById('carInput').value.trim().toUpperCase();
    if(car === correctCar){
      carModal.hide();
      document.getElementById('winSound').play().catch(()=>{});
      launchConfetti();
      wModal.show();
    } else {
      document.getElementById('carHint').innerText = 'тЭМ ркЦрлЛркЯрлЛ ркиркВркмрк░, рклрк░рлА рккрлНрк░ркпрк╛рк╕ ркХрк░рлЛ.';
    }
  }

  function launchConfetti(){
    for(let i=0;i<60;i++){
      const el = document.createElement('div');
      el.className='confetti';
      el.style.left=(10+Math.random()*80)+'%';
      el.style.top=(10+Math.random()*30)+'%';
      el.style.width='8px'; el.style.height='12px';
      el.style.background = `hsl(${Math.random()*360},80%,60%)`;
      el.style.opacity=0.95;
      el.style.transform = `rotate(${Math.random()*360}deg)`;
      el.style.transition = 'transform 1200ms linear, opacity 1200ms linear';
      document.body.appendChild(el);
      setTimeout(()=> {
        el.style.transform = `translateY(${400+Math.random()*300}px) rotate(${Math.random()*720}deg)`;
        el.style.opacity='0';
      }, 20);
      setTimeout(()=> el.remove(), 1400);
    }
  }

  function log(msg){
    const l = document.getElementById('log');
    const p = document.createElement('div');
    p.innerText = `[${new Date().toLocaleTimeString()}] ${msg}`;
    l.prepend(p);
  }
</script>
</body>
</html>
